---
// Basic Light Call To Action section
// ------------
// Description: A centered call to action section that contains: a title, text, an optional rating and a button.
// Components
// - Layout
import Section from '../../ui/Section.astro'
import Row from '../../ui/Row.astro'
import Col from '../../ui/Col.astro'
// - UI
import CTA from '../../ui/CTA.astro'
import Button from '../../ui/Button.astro'
import Ratings from '../../ui/Rating.astro'
// Content
import CTALightData from '../../../data/json-files/ctaLightData.json'

// Type for the rating data
interface RatingData {
  stars?: 0 | 1 | 2 | 3 | 4 | 5;
  text?: string;
}
interface CTALightData {
  title: string;
  text: string;
  button: {
    text: string;
    link: string;
  };
  rating?: {
    stars: 0 | 1 | 2 | 3 | 4 | 5;
    text?: string;
  };
}
// Check if rating exists and has valid stars
const hasRating = CTALightData.rating &&
                  typeof CTALightData.rating === 'object' &&
                  'stars' in CTALightData.rating &&
                  typeof CTALightData.rating.stars === 'number' &&
                  CTALightData.rating.stars >= 0 &&
                  CTALightData.rating.stars <= 5;
---
<Section>
  <Row>
    <Col span="1" />
    <Col span="10">
      <CTA
        title={CTALightData.title}
        text={CTALightData.text}
        classes="!shadow-none"
      >
        {hasRating && (
          <Ratings
            rating={CTALightData.rating.stars}
            text={CTALightData.rating.text}
            classes="mb-4"
          />
        )}
        <Button
          size="lg"
          style="primary"
          link={CTALightData.button.link}
        >
          {CTALightData.button.text}
        </Button>
      </CTA>
    </Col>
    <Col span="1" />
  </Row>
</Section>